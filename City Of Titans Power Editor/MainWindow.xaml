<Window x:Name="wndMain" x:Class="CityOfTitansPowerEditor.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:CityOfTitansPowerEditor"
        mc:Ignorable="d"
        Height="482" Width="525" WindowStyle="None" Background="Transparent"
  BorderThickness="6"
  ResizeMode="CanResizeWithGrip" Icon="MWM.ico">
    <Window.Resources>
        <Style x:Key="FocusVisual">
            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Rectangle Margin="2" SnapsToDevicePixels="true" Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" StrokeThickness="1" StrokeDashArray="1 2"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <SolidColorBrush x:Key="Button.Static.Background" Color="#FFDDDDDD"/>
        <SolidColorBrush x:Key="Button.Static.Border" Color="#FF707070"/>
        <SolidColorBrush x:Key="Button.MouseOver.Background" Color="#FFBEE6FD"/>
        <SolidColorBrush x:Key="Button.MouseOver.Border" Color="#FF3C7FB1"/>
        <SolidColorBrush x:Key="Button.Pressed.Background" Color="#FFC4E5F6"/>
        <SolidColorBrush x:Key="Button.Pressed.Border" Color="#FF2C628B"/>
        <SolidColorBrush x:Key="Button.Disabled.Background" Color="#FFF4F4F4"/>
        <SolidColorBrush x:Key="Button.Disabled.Border" Color="#FFADB2B5"/>
        <SolidColorBrush x:Key="Button.Disabled.Foreground" Color="#FF838383"/>

        <Style x:Key="MinimizeButtonStyle" TargetType="{x:Type Button}">
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Padding" Value="1"/>
            <Setter Property="Margin" Value="5,5,2.5,5"/>

            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border x:Name="border" BorderBrush="Transparent" BorderThickness="0" SnapsToDevicePixels="true">
                            <Border.Effect>
                                <DropShadowEffect/>
                            </Border.Effect>

                            <Border.Background>
                                <DrawingBrush Stretch="UniformToFill">
                                    <DrawingBrush.Drawing>
                                        <DrawingGroup>
                                            <DrawingGroup Transform="1,0,0,1,93.854,4.576">
                                                <DrawingGroup Transform="0.677,0,0,0.676,-394.662,131.968">

                                                    <DrawingGroup Transform="1,0,0,1,-49.888,-125.272">
                                                        <GeometryDrawing Geometry="F1M566.746,-39.409A35.709,35.709,0.000,1,1,566.738,-40.145">
                                                            <GeometryDrawing.Brush>
                                                                <RadialGradientBrush Center="531.037,-27.632" GradientOrigin="531.037,-27.632" MappingMode="Absolute" RadiusX="37.709" RadiusY="37.709" Transform="0.870,0,0,0.870,68.738,-5.101">
                                                                    <GradientStop x:Name="StartColor" Offset="0" Color="Lime"/>
                                                                    <GradientStop x:Name="StopColor" Offset="1" Color="Green"/>
                                                                </RadialGradientBrush>
                                                            </GeometryDrawing.Brush>

                                                            <GeometryDrawing.Pen>
                                                                <Pen DashCap="Round" EndLineCap="Round" LineJoin="Round"
                    												MiterLimit="4" StartLineCap="Round" Thickness="2.954">
                                                                    <Pen.Brush>
                                                                        <LinearGradientBrush EndPoint="531.006,-76.4" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="531.006,-1.24">
                                                                            <GradientStop Offset="0" Color="Black" />
                                                                            <GradientStop Offset=".5" Color="Silver" />
                                                                            <GradientStop Offset="1" Color="White"/>
                                                                        </LinearGradientBrush>
                                                                    </Pen.Brush>
                                                                </Pen>
                                                            </GeometryDrawing.Pen>
                                                        </GeometryDrawing>
                                                    </DrawingGroup>

                                                    <DrawingGroup Transform="1.014,0,0,1.039,-84.726,-157.136">
                                                        <GeometryDrawing Geometry="F1M581.242,-21.201A23.688,17.854,0.000,1,1,533.866,-21.201A23.688,17.854,0.000,1,1,581.242,-21.201z">
                                                            <GeometryDrawing.Brush>
                                                                <LinearGradientBrush EndPoint="557.554,-3.347" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="557.554,-39.056">
                                                                    <GradientStop Offset="0" Color="White"/>
                                                                    <GradientStop Offset="1" Color="Transparent"/>
                                                                </LinearGradientBrush>
                                                            </GeometryDrawing.Brush>
                                                        </GeometryDrawing>
                                                    </DrawingGroup>

                                                    <GeometryDrawing Geometry="F1M451.417,-150.269C458.518,-134.471 476.859,-126.846 493.169,-133.221 509.471,-139.593 517.781,-157.618 512.306,-174.037 507.882,-162.931 499.032,-153.626 487.028,-148.934 475.012,-144.238 462.206,-145.094 451.417,-150.269z">
                                                        <GeometryDrawing.Brush>
                                                            <LinearGradientBrush EndPoint="486.709,-158.586" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="493.474,-133.339">
                                                                <GradientStop Offset="0" Color="White"/>
                                                                <GradientStop Offset="1" Color="Transparent"/>
                                                            </LinearGradientBrush>
                                                        </GeometryDrawing.Brush>
                                                    </GeometryDrawing>

                                                </DrawingGroup>
                                            </DrawingGroup>
                                        </DrawingGroup>
                                    </DrawingBrush.Drawing>
                                </DrawingBrush>
                            </Border.Background>

                            <ContentPresenter x:Name="contentPresenter" Focusable="False" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Border>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsDefault" Value="true">
                            </Trigger>

                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter Property="Background" TargetName="border">
                                    <Setter.Value>
                                        <DrawingBrush Stretch="UniformToFill">
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Transform>
                                                            <MatrixTransform Matrix="1,0,0,1,93.854,4.576"/>
                                                        </DrawingGroup.Transform>
                                                        <DrawingGroup>
                                                            <DrawingGroup.Transform>
                                                                <MatrixTransform Matrix="0.677,0,0,0.676,-394.662,131.968"/>
                                                            </DrawingGroup.Transform>
                                                            <DrawingGroup>
                                                                <DrawingGroup.Transform>
                                                                    <MatrixTransform Matrix="1,0,0,1,-49.888,-125.272"/>
                                                                </DrawingGroup.Transform>
                                                                <GeometryDrawing Geometry="F1M566.746,-39.409A35.709,35.709,0,1,1,566.738,-40.145">
                                                                    <GeometryDrawing.Brush>
                                                                        <RadialGradientBrush Center="531.037,-27.632" GradientOrigin="531.037,-27.632" MappingMode="Absolute" RadiusY="37.709" RadiusX="37.709">
                                                                            <RadialGradientBrush.Transform>
                                                                                <MatrixTransform Matrix="0.87,0,0,0.87,68.738,-5.101"/>
                                                                            </RadialGradientBrush.Transform>
                                                                            <GradientStop Color="Lime" Offset="0"/>
                                                                            <GradientStop Color="#FF00C000" Offset="1"/>
                                                                        </RadialGradientBrush>
                                                                    </GeometryDrawing.Brush>
                                                                    <GeometryDrawing.Pen>
                                                                        <Pen DashCap="Round" EndLineCap="Round" LineJoin="Round" MiterLimit="4" StartLineCap="Round" Thickness="2.954">
                                                                            <Pen.Brush>
                                                                                <LinearGradientBrush EndPoint="531.006,-76.4" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="531.006,-1.24">
                                                                                    <GradientStop Color="Black" Offset="0"/>
                                                                                    <GradientStop Color="Silver" Offset="0.5"/>
                                                                                    <GradientStop Color="White" Offset="1"/>
                                                                                </LinearGradientBrush>
                                                                            </Pen.Brush>
                                                                        </Pen>
                                                                    </GeometryDrawing.Pen>
                                                                </GeometryDrawing>
                                                            </DrawingGroup>
                                                            <DrawingGroup>
                                                                <DrawingGroup.Transform>
                                                                    <MatrixTransform Matrix="1.014,0,0,1.039,-84.726,-157.136"/>
                                                                </DrawingGroup.Transform>
                                                                <GeometryDrawing Geometry="F1M581.242,-21.201A23.688,17.854,0,1,1,533.866,-21.201A23.688,17.854,0,1,1,581.242,-21.201z">
                                                                    <GeometryDrawing.Brush>
                                                                        <LinearGradientBrush EndPoint="557.554,-3.347" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="557.554,-39.056">
                                                                            <GradientStop Color="White" Offset="0"/>
                                                                            <GradientStop Color="Transparent" Offset="1"/>
                                                                        </LinearGradientBrush>
                                                                    </GeometryDrawing.Brush>
                                                                </GeometryDrawing>
                                                            </DrawingGroup>
                                                            <GeometryDrawing Geometry="F1M451.417,-150.269C458.518,-134.471 476.859,-126.846 493.169,-133.221 509.471,-139.593 517.781,-157.618 512.306,-174.037 507.882,-162.931 499.032,-153.626 487.028,-148.934 475.012,-144.238 462.206,-145.094 451.417,-150.269z">
                                                                <GeometryDrawing.Brush>
                                                                    <LinearGradientBrush EndPoint="486.709,-158.586" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="493.474,-133.339">
                                                                        <GradientStop Color="White" Offset="0"/>
                                                                        <GradientStop Color="Transparent" Offset="1"/>
                                                                    </LinearGradientBrush>
                                                                </GeometryDrawing.Brush>
                                                            </GeometryDrawing>
                                                        </DrawingGroup>
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>

                            <Trigger Property="IsPressed" Value="true">
                                <Setter Property="Background" TargetName="border">
                                    <Setter.Value>
                                        <DrawingBrush Stretch="UniformToFill">
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Transform>
                                                            <MatrixTransform Matrix="1,0,0,1,93.854,4.576"/>
                                                        </DrawingGroup.Transform>
                                                        <DrawingGroup>
                                                            <DrawingGroup.Transform>
                                                                <MatrixTransform Matrix="0.677,0,0,0.676,-394.662,131.968"/>
                                                            </DrawingGroup.Transform>
                                                            <DrawingGroup>
                                                                <DrawingGroup.Transform>
                                                                    <MatrixTransform Matrix="1,0,0,1,-49.888,-125.272"/>
                                                                </DrawingGroup.Transform>
                                                                <GeometryDrawing Geometry="F1M566.746,-39.409A35.709,35.709,0,1,1,566.738,-40.145">
                                                                    <GeometryDrawing.Brush>
                                                                        <RadialGradientBrush Center="531.037,-27.632" GradientOrigin="531.037,-27.632" MappingMode="Absolute" RadiusY="37.709" RadiusX="37.709">
                                                                            <RadialGradientBrush.Transform>
                                                                                <MatrixTransform Matrix="0.87,0,0,0.87,68.738,-5.101"/>
                                                                            </RadialGradientBrush.Transform>
                                                                            <GradientStop Color="Green" Offset="0"/>
                                                                            <GradientStop Color="#FF00C000" Offset="1"/>
                                                                        </RadialGradientBrush>
                                                                    </GeometryDrawing.Brush>
                                                                    <GeometryDrawing.Pen>
                                                                        <Pen DashCap="Round" EndLineCap="Round" LineJoin="Round" MiterLimit="4" StartLineCap="Round" Thickness="2.954">
                                                                            <Pen.Brush>
                                                                                <LinearGradientBrush EndPoint="531.006,-76.4" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="531.006,-1.24">
                                                                                    <GradientStop Color="Black" Offset="0"/>
                                                                                    <GradientStop Color="Silver" Offset="0.5"/>
                                                                                    <GradientStop Color="White" Offset="1"/>
                                                                                </LinearGradientBrush>
                                                                            </Pen.Brush>
                                                                        </Pen>
                                                                    </GeometryDrawing.Pen>
                                                                </GeometryDrawing>
                                                            </DrawingGroup>
                                                            <DrawingGroup>
                                                                <DrawingGroup.Transform>
                                                                    <MatrixTransform Matrix="1.014,0,0,1.039,-84.726,-157.136"/>
                                                                </DrawingGroup.Transform>
                                                                <GeometryDrawing Geometry="F1M581.242,-21.201A23.688,17.854,0,1,1,533.866,-21.201A23.688,17.854,0,1,1,581.242,-21.201z">
                                                                    <GeometryDrawing.Brush>
                                                                        <LinearGradientBrush EndPoint="557.554,-3.347" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="557.554,-39.056">
                                                                            <GradientStop Color="White" Offset="0"/>
                                                                            <GradientStop Color="Transparent" Offset="1"/>
                                                                        </LinearGradientBrush>
                                                                    </GeometryDrawing.Brush>
                                                                </GeometryDrawing>
                                                            </DrawingGroup>
                                                            <GeometryDrawing Geometry="F1M451.417,-150.269C458.518,-134.471 476.859,-126.846 493.169,-133.221 509.471,-139.593 517.781,-157.618 512.306,-174.037 507.882,-162.931 499.032,-153.626 487.028,-148.934 475.012,-144.238 462.206,-145.094 451.417,-150.269z">
                                                                <GeometryDrawing.Brush>
                                                                    <LinearGradientBrush EndPoint="486.709,-158.586" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="493.474,-133.339">
                                                                        <GradientStop Color="White" Offset="0"/>
                                                                        <GradientStop Color="Transparent" Offset="1"/>
                                                                    </LinearGradientBrush>
                                                                </GeometryDrawing.Brush>
                                                            </GeometryDrawing>
                                                        </DrawingGroup>
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="RestoreButtonStyle" TargetType="{x:Type Button}">
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Padding" Value="1"/>
            <Setter Property="Margin" Value="5,5,2.5,5"/>

            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border x:Name="border" BorderBrush="Transparent" BorderThickness="0" SnapsToDevicePixels="true">
                            <Border.Effect>
                                <DropShadowEffect/>
                            </Border.Effect>

                            <Border.Background>
                                <DrawingBrush Stretch="UniformToFill">
                                    <DrawingBrush.Drawing>
                                        <DrawingGroup>
                                            <DrawingGroup Transform="1,0,0,1,93.854,4.576">
                                                <DrawingGroup Transform="0.677,0,0,0.676,-394.662,131.968">

                                                    <DrawingGroup Transform="1,0,0,1,-49.888,-125.272">
                                                        <GeometryDrawing Geometry="F1M566.746,-39.409A35.709,35.709,0.000,1,1,566.738,-40.145">
                                                            <GeometryDrawing.Brush>
                                                                <RadialGradientBrush Center="531.037,-27.632" GradientOrigin="531.037,-27.632" MappingMode="Absolute" RadiusX="37.709" RadiusY="37.709" Transform="0.870,0,0,0.870,68.738,-5.101">
                                                                    <GradientStop x:Name="StartColor" Offset="0" Color="Yellow"/>
                                                                    <GradientStop x:Name="StopColor" Offset="1" Color="#FF808000"/>
                                                                </RadialGradientBrush>
                                                            </GeometryDrawing.Brush>

                                                            <GeometryDrawing.Pen>
                                                                <Pen DashCap="Round" EndLineCap="Round" LineJoin="Round"
                    												MiterLimit="4" StartLineCap="Round" Thickness="2.954">
                                                                    <Pen.Brush>
                                                                        <LinearGradientBrush EndPoint="531.006,-76.4" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="531.006,-1.24">
                                                                            <GradientStop Offset="0" Color="Black" />
                                                                            <GradientStop Offset=".5" Color="Silver" />
                                                                            <GradientStop Offset="1" Color="White"/>
                                                                        </LinearGradientBrush>
                                                                    </Pen.Brush>
                                                                </Pen>
                                                            </GeometryDrawing.Pen>
                                                        </GeometryDrawing>
                                                    </DrawingGroup>

                                                    <DrawingGroup Transform="1.014,0,0,1.039,-84.726,-157.136">
                                                        <GeometryDrawing Geometry="F1M581.242,-21.201A23.688,17.854,0.000,1,1,533.866,-21.201A23.688,17.854,0.000,1,1,581.242,-21.201z">
                                                            <GeometryDrawing.Brush>
                                                                <LinearGradientBrush EndPoint="557.554,-3.347" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="557.554,-39.056">
                                                                    <GradientStop Offset="0" Color="White"/>
                                                                    <GradientStop Offset="1" Color="Transparent"/>
                                                                </LinearGradientBrush>
                                                            </GeometryDrawing.Brush>
                                                        </GeometryDrawing>
                                                    </DrawingGroup>

                                                    <GeometryDrawing Geometry="F1M451.417,-150.269C458.518,-134.471 476.859,-126.846 493.169,-133.221 509.471,-139.593 517.781,-157.618 512.306,-174.037 507.882,-162.931 499.032,-153.626 487.028,-148.934 475.012,-144.238 462.206,-145.094 451.417,-150.269z">
                                                        <GeometryDrawing.Brush>
                                                            <LinearGradientBrush EndPoint="486.709,-158.586" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="493.474,-133.339">
                                                                <GradientStop Offset="0" Color="White"/>
                                                                <GradientStop Offset="1" Color="Transparent"/>
                                                            </LinearGradientBrush>
                                                        </GeometryDrawing.Brush>
                                                    </GeometryDrawing>

                                                </DrawingGroup>
                                            </DrawingGroup>
                                        </DrawingGroup>
                                    </DrawingBrush.Drawing>
                                </DrawingBrush>
                            </Border.Background>

                            <ContentPresenter x:Name="contentPresenter" Focusable="False" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Border>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsDefault" Value="true">
                            </Trigger>

                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter Property="Background" TargetName="border">
                                    <Setter.Value>
                                        <DrawingBrush Stretch="UniformToFill">
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Transform>
                                                            <MatrixTransform Matrix="1,0,0,1,93.854,4.576"/>
                                                        </DrawingGroup.Transform>

                                                        <DrawingGroup>
                                                            <DrawingGroup.Transform>
                                                                <MatrixTransform Matrix="0.677,0,0,0.676,-394.662,131.968"/>
                                                            </DrawingGroup.Transform>

                                                            <DrawingGroup>
                                                                <DrawingGroup.Transform>
                                                                    <MatrixTransform Matrix="1,0,0,1,-49.888,-125.272"/>
                                                                </DrawingGroup.Transform>

                                                                <GeometryDrawing Geometry="F1M566.746,-39.409A35.709,35.709,0,1,1,566.738,-40.145">
                                                                    <GeometryDrawing.Brush>
                                                                        <RadialGradientBrush Center="531.037,-27.632" GradientOrigin="531.037,-27.632" MappingMode="Absolute" RadiusY="37.709" RadiusX="37.709">
                                                                            <RadialGradientBrush.Transform>
                                                                                <MatrixTransform Matrix="0.87,0,0,0.87,68.738,-5.101"/>
                                                                            </RadialGradientBrush.Transform>
                                                                            <GradientStop Color="Yellow" Offset="0"/>
                                                                            <GradientStop Color="#FFC0C000" Offset="1"/>
                                                                        </RadialGradientBrush>
                                                                    </GeometryDrawing.Brush>

                                                                    <GeometryDrawing.Pen>
                                                                        <Pen DashCap="Round" EndLineCap="Round" LineJoin="Round" MiterLimit="4" StartLineCap="Round" Thickness="2.954">
                                                                            <Pen.Brush>
                                                                                <LinearGradientBrush EndPoint="531.006,-76.4" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="531.006,-1.24">
                                                                                    <GradientStop Color="Black" Offset="0"/>
                                                                                    <GradientStop Color="Silver" Offset="0.5"/>
                                                                                    <GradientStop Color="White" Offset="1"/>
                                                                                </LinearGradientBrush>
                                                                            </Pen.Brush>
                                                                        </Pen>
                                                                    </GeometryDrawing.Pen>
                                                                </GeometryDrawing>
                                                            </DrawingGroup>

                                                            <DrawingGroup>
                                                                <DrawingGroup.Transform>
                                                                    <MatrixTransform Matrix="1.014,0,0,1.039,-84.726,-157.136"/>
                                                                </DrawingGroup.Transform>
                                                                <GeometryDrawing Geometry="F1M581.242,-21.201A23.688,17.854,0,1,1,533.866,-21.201A23.688,17.854,0,1,1,581.242,-21.201z">
                                                                    <GeometryDrawing.Brush>
                                                                        <LinearGradientBrush EndPoint="557.554,-3.347" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="557.554,-39.056">
                                                                            <GradientStop Color="White" Offset="0"/>
                                                                            <GradientStop Color="Transparent" Offset="1"/>
                                                                        </LinearGradientBrush>
                                                                    </GeometryDrawing.Brush>
                                                                </GeometryDrawing>
                                                            </DrawingGroup>

                                                            <GeometryDrawing Geometry="F1M451.417,-150.269C458.518,-134.471 476.859,-126.846 493.169,-133.221 509.471,-139.593 517.781,-157.618 512.306,-174.037 507.882,-162.931 499.032,-153.626 487.028,-148.934 475.012,-144.238 462.206,-145.094 451.417,-150.269z">
                                                                <GeometryDrawing.Brush>
                                                                    <LinearGradientBrush EndPoint="486.709,-158.586" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="493.474,-133.339">
                                                                        <GradientStop Color="White" Offset="0"/>
                                                                        <GradientStop Color="Transparent" Offset="1"/>
                                                                    </LinearGradientBrush>
                                                                </GeometryDrawing.Brush>
                                                            </GeometryDrawing>
                                                        </DrawingGroup>
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>

                            <Trigger Property="IsPressed" Value="true">
                                <Setter Property="Background" TargetName="border">
                                    <Setter.Value>
                                        <DrawingBrush Stretch="UniformToFill">
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Transform>
                                                            <MatrixTransform Matrix="1,0,0,1,93.854,4.576"/>
                                                        </DrawingGroup.Transform>

                                                        <DrawingGroup>
                                                            <DrawingGroup.Transform>
                                                                <MatrixTransform Matrix="0.677,0,0,0.676,-394.662,131.968"/>
                                                            </DrawingGroup.Transform>

                                                            <DrawingGroup>
                                                                <DrawingGroup.Transform>
                                                                    <MatrixTransform Matrix="1,0,0,1,-49.888,-125.272"/>
                                                                </DrawingGroup.Transform>

                                                                <GeometryDrawing Geometry="F1M566.746,-39.409A35.709,35.709,0,1,1,566.738,-40.145">
                                                                    <GeometryDrawing.Brush>
                                                                        <RadialGradientBrush Center="531.037,-27.632" GradientOrigin="531.037,-27.632" MappingMode="Absolute" RadiusY="37.709" RadiusX="37.709">
                                                                            <RadialGradientBrush.Transform>
                                                                                <MatrixTransform Matrix="0.87,0,0,0.87,68.738,-5.101"/>
                                                                            </RadialGradientBrush.Transform>
                                                                            <GradientStop Color="#FFC0C000" Offset="0"/>
                                                                            <GradientStop Color="Yellow" Offset="1"/>
                                                                        </RadialGradientBrush>
                                                                    </GeometryDrawing.Brush>

                                                                    <GeometryDrawing.Pen>
                                                                        <Pen DashCap="Round" EndLineCap="Round" LineJoin="Round" MiterLimit="4" StartLineCap="Round" Thickness="2.954">
                                                                            <Pen.Brush>
                                                                                <LinearGradientBrush EndPoint="531.006,-76.4" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="531.006,-1.24">
                                                                                    <GradientStop Color="Black" Offset="0"/>
                                                                                    <GradientStop Color="Silver" Offset="0.5"/>
                                                                                    <GradientStop Color="White" Offset="1"/>
                                                                                </LinearGradientBrush>
                                                                            </Pen.Brush>
                                                                        </Pen>
                                                                    </GeometryDrawing.Pen>
                                                                </GeometryDrawing>
                                                            </DrawingGroup>

                                                            <DrawingGroup>
                                                                <DrawingGroup.Transform>
                                                                    <MatrixTransform Matrix="1.014,0,0,1.039,-84.726,-157.136"/>
                                                                </DrawingGroup.Transform>

                                                                <GeometryDrawing Geometry="F1M581.242,-21.201A23.688,17.854,0,1,1,533.866,-21.201A23.688,17.854,0,1,1,581.242,-21.201z">
                                                                    <GeometryDrawing.Brush>
                                                                        <LinearGradientBrush EndPoint="557.554,-3.347" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="557.554,-39.056">
                                                                            <GradientStop Color="White" Offset="0"/>
                                                                            <GradientStop Color="Transparent" Offset="1"/>
                                                                        </LinearGradientBrush>
                                                                    </GeometryDrawing.Brush>
                                                                </GeometryDrawing>
                                                            </DrawingGroup>

                                                            <GeometryDrawing Geometry="F1M451.417,-150.269C458.518,-134.471 476.859,-126.846 493.169,-133.221 509.471,-139.593 517.781,-157.618 512.306,-174.037 507.882,-162.931 499.032,-153.626 487.028,-148.934 475.012,-144.238 462.206,-145.094 451.417,-150.269z">
                                                                <GeometryDrawing.Brush>
                                                                    <LinearGradientBrush EndPoint="486.709,-158.586" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="493.474,-133.339">
                                                                        <GradientStop Color="White" Offset="0"/>
                                                                        <GradientStop Color="Transparent" Offset="1"/>
                                                                    </LinearGradientBrush>
                                                                </GeometryDrawing.Brush>
                                                            </GeometryDrawing>
                                                        </DrawingGroup>
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CloseButtonStyle" TargetType="{x:Type Button}">
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Padding" Value="1"/>
            <Setter Property="Margin" Value="5,5,2.5,0"/>

            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border x:Name="border" BorderBrush="Transparent" BorderThickness="0" SnapsToDevicePixels="true">
                            <Border.Effect>
                                <DropShadowEffect/>
                            </Border.Effect>

                            <Border.Background>
                                <DrawingBrush Stretch="UniformToFill">
                                    <DrawingBrush.Drawing>
                                        <DrawingGroup>
                                            <DrawingGroup Transform="1,0,0,1,93.854,4.576">
                                                <DrawingGroup Transform="0.677,0,0,0.676,-394.662,131.968">

                                                    <DrawingGroup Transform="1,0,0,1,-49.888,-125.272">
                                                        <GeometryDrawing Geometry="F1M566.746,-39.409A35.709,35.709,0.000,1,1,566.738,-40.145">
                                                            <GeometryDrawing.Brush>
                                                                <RadialGradientBrush Center="531.037,-27.632" GradientOrigin="531.037,-27.632" MappingMode="Absolute" RadiusX="37.709" RadiusY="37.709" Transform="0.870,0,0,0.870,68.738,-5.101">
                                                                    <GradientStop x:Name="StartColor" Offset="0" Color="Red"/>
                                                                    <GradientStop x:Name="StopColor" Offset="1" Color="#FF800000"/>
                                                                </RadialGradientBrush>
                                                            </GeometryDrawing.Brush>

                                                            <GeometryDrawing.Pen>
                                                                <Pen DashCap="Round" EndLineCap="Round" LineJoin="Round"
                    												MiterLimit="4" StartLineCap="Round" Thickness="2.954">
                                                                    <Pen.Brush>
                                                                        <LinearGradientBrush EndPoint="531.006,-76.4" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="531.006,-1.24">
                                                                            <GradientStop Offset="0" Color="Black" />
                                                                            <GradientStop Offset=".5" Color="Silver" />
                                                                            <GradientStop Offset="1" Color="White"/>
                                                                        </LinearGradientBrush>
                                                                    </Pen.Brush>
                                                                </Pen>
                                                            </GeometryDrawing.Pen>
                                                        </GeometryDrawing>
                                                    </DrawingGroup>

                                                    <DrawingGroup Transform="1.014,0,0,1.039,-84.726,-157.136">
                                                        <GeometryDrawing Geometry="F1M581.242,-21.201A23.688,17.854,0.000,1,1,533.866,-21.201A23.688,17.854,0.000,1,1,581.242,-21.201z">
                                                            <GeometryDrawing.Brush>
                                                                <LinearGradientBrush EndPoint="557.554,-3.347" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="557.554,-39.056">
                                                                    <GradientStop Offset="0" Color="White"/>
                                                                    <GradientStop Offset="1" Color="Transparent"/>
                                                                </LinearGradientBrush>
                                                            </GeometryDrawing.Brush>
                                                        </GeometryDrawing>
                                                    </DrawingGroup>

                                                    <GeometryDrawing Geometry="F1M451.417,-150.269C458.518,-134.471 476.859,-126.846 493.169,-133.221 509.471,-139.593 517.781,-157.618 512.306,-174.037 507.882,-162.931 499.032,-153.626 487.028,-148.934 475.012,-144.238 462.206,-145.094 451.417,-150.269z">
                                                        <GeometryDrawing.Brush>
                                                            <LinearGradientBrush EndPoint="486.709,-158.586" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="493.474,-133.339">
                                                                <GradientStop Offset="0" Color="White"/>
                                                                <GradientStop Offset="1" Color="Transparent"/>
                                                            </LinearGradientBrush>
                                                        </GeometryDrawing.Brush>
                                                    </GeometryDrawing>

                                                </DrawingGroup>
                                            </DrawingGroup>
                                        </DrawingGroup>
                                    </DrawingBrush.Drawing>
                                </DrawingBrush>
                            </Border.Background>

                            <ContentPresenter x:Name="contentPresenter" Focusable="False" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Border>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsDefault" Value="true">
                            </Trigger>

                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter Property="Background" TargetName="border">
                                    <Setter.Value>
                                        <DrawingBrush Stretch="UniformToFill">
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Transform>
                                                            <MatrixTransform Matrix="1,0,0,1,93.854,4.576"/>
                                                        </DrawingGroup.Transform>

                                                        <DrawingGroup>
                                                            <DrawingGroup.Transform>
                                                                <MatrixTransform Matrix="0.677,0,0,0.676,-394.662,131.968"/>
                                                            </DrawingGroup.Transform>

                                                            <DrawingGroup>
                                                                <DrawingGroup.Transform>
                                                                    <MatrixTransform Matrix="1,0,0,1,-49.888,-125.272"/>
                                                                </DrawingGroup.Transform>

                                                                <GeometryDrawing Geometry="F1M566.746,-39.409A35.709,35.709,0,1,1,566.738,-40.145">
                                                                    <GeometryDrawing.Brush>
                                                                        <RadialGradientBrush Center="531.037,-27.632" GradientOrigin="531.037,-27.632" MappingMode="Absolute" RadiusY="37.709" RadiusX="37.709">
                                                                            <RadialGradientBrush.Transform>
                                                                                <MatrixTransform Matrix="0.87,0,0,0.87,68.738,-5.101"/>
                                                                            </RadialGradientBrush.Transform>
                                                                            <GradientStop Color="Red" Offset="0"/>
                                                                            <GradientStop Color="#FFC00000" Offset="1"/>
                                                                        </RadialGradientBrush>
                                                                    </GeometryDrawing.Brush>

                                                                    <GeometryDrawing.Pen>
                                                                        <Pen DashCap="Round" EndLineCap="Round" LineJoin="Round" MiterLimit="4" StartLineCap="Round" Thickness="2.954">
                                                                            <Pen.Brush>
                                                                                <LinearGradientBrush EndPoint="531.006,-76.4" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="531.006,-1.24">
                                                                                    <GradientStop Color="Black" Offset="0"/>
                                                                                    <GradientStop Color="Silver" Offset="0.5"/>
                                                                                    <GradientStop Color="White" Offset="1"/>
                                                                                </LinearGradientBrush>
                                                                            </Pen.Brush>
                                                                        </Pen>
                                                                    </GeometryDrawing.Pen>
                                                                </GeometryDrawing>
                                                            </DrawingGroup>

                                                            <DrawingGroup>
                                                                <DrawingGroup.Transform>
                                                                    <MatrixTransform Matrix="1.014,0,0,1.039,-84.726,-157.136"/>
                                                                </DrawingGroup.Transform>
                                                                <GeometryDrawing Geometry="F1M581.242,-21.201A23.688,17.854,0,1,1,533.866,-21.201A23.688,17.854,0,1,1,581.242,-21.201z">
                                                                    <GeometryDrawing.Brush>
                                                                        <LinearGradientBrush EndPoint="557.554,-3.347" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="557.554,-39.056">
                                                                            <GradientStop Color="White" Offset="0"/>
                                                                            <GradientStop Color="Transparent" Offset="1"/>
                                                                        </LinearGradientBrush>
                                                                    </GeometryDrawing.Brush>
                                                                </GeometryDrawing>
                                                            </DrawingGroup>

                                                            <GeometryDrawing Geometry="F1M451.417,-150.269C458.518,-134.471 476.859,-126.846 493.169,-133.221 509.471,-139.593 517.781,-157.618 512.306,-174.037 507.882,-162.931 499.032,-153.626 487.028,-148.934 475.012,-144.238 462.206,-145.094 451.417,-150.269z">
                                                                <GeometryDrawing.Brush>
                                                                    <LinearGradientBrush EndPoint="486.709,-158.586" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="493.474,-133.339">
                                                                        <GradientStop Color="White" Offset="0"/>
                                                                        <GradientStop Color="Transparent" Offset="1"/>
                                                                    </LinearGradientBrush>
                                                                </GeometryDrawing.Brush>
                                                            </GeometryDrawing>
                                                        </DrawingGroup>
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>

                            <Trigger Property="IsPressed" Value="true">
                                <Setter Property="Background" TargetName="border">
                                    <Setter.Value>
                                        <DrawingBrush Stretch="UniformToFill">
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Transform>
                                                            <MatrixTransform Matrix="1,0,0,1,93.854,4.576"/>
                                                        </DrawingGroup.Transform>

                                                        <DrawingGroup>
                                                            <DrawingGroup.Transform>
                                                                <MatrixTransform Matrix="0.677,0,0,0.676,-394.662,131.968"/>
                                                            </DrawingGroup.Transform>

                                                            <DrawingGroup>
                                                                <DrawingGroup.Transform>
                                                                    <MatrixTransform Matrix="1,0,0,1,-49.888,-125.272"/>
                                                                </DrawingGroup.Transform>

                                                                <GeometryDrawing Geometry="F1M566.746,-39.409A35.709,35.709,0,1,1,566.738,-40.145">
                                                                    <GeometryDrawing.Brush>
                                                                        <RadialGradientBrush Center="531.037,-27.632" GradientOrigin="531.037,-27.632" MappingMode="Absolute" RadiusY="37.709" RadiusX="37.709">
                                                                            <RadialGradientBrush.Transform>
                                                                                <MatrixTransform Matrix="0.87,0,0,0.87,68.738,-5.101"/>
                                                                            </RadialGradientBrush.Transform>
                                                                            <GradientStop Color="#FFC00000" Offset="0"/>
                                                                            <GradientStop Color="Red" Offset="1"/>
                                                                        </RadialGradientBrush>
                                                                    </GeometryDrawing.Brush>

                                                                    <GeometryDrawing.Pen>
                                                                        <Pen DashCap="Round" EndLineCap="Round" LineJoin="Round" MiterLimit="4" StartLineCap="Round" Thickness="2.954">
                                                                            <Pen.Brush>
                                                                                <LinearGradientBrush EndPoint="531.006,-76.4" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="531.006,-1.24">
                                                                                    <GradientStop Color="Black" Offset="0"/>
                                                                                    <GradientStop Color="Silver" Offset="0.5"/>
                                                                                    <GradientStop Color="White" Offset="1"/>
                                                                                </LinearGradientBrush>
                                                                            </Pen.Brush>
                                                                        </Pen>
                                                                    </GeometryDrawing.Pen>
                                                                </GeometryDrawing>
                                                            </DrawingGroup>

                                                            <DrawingGroup>
                                                                <DrawingGroup.Transform>
                                                                    <MatrixTransform Matrix="1.014,0,0,1.039,-84.726,-157.136"/>
                                                                </DrawingGroup.Transform>

                                                                <GeometryDrawing Geometry="F1M581.242,-21.201A23.688,17.854,0,1,1,533.866,-21.201A23.688,17.854,0,1,1,581.242,-21.201z">
                                                                    <GeometryDrawing.Brush>
                                                                        <LinearGradientBrush EndPoint="557.554,-3.347" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="557.554,-39.056">
                                                                            <GradientStop Color="White" Offset="0"/>
                                                                            <GradientStop Color="Transparent" Offset="1"/>
                                                                        </LinearGradientBrush>
                                                                    </GeometryDrawing.Brush>
                                                                </GeometryDrawing>
                                                            </DrawingGroup>

                                                            <GeometryDrawing Geometry="F1M451.417,-150.269C458.518,-134.471 476.859,-126.846 493.169,-133.221 509.471,-139.593 517.781,-157.618 512.306,-174.037 507.882,-162.931 499.032,-153.626 487.028,-148.934 475.012,-144.238 462.206,-145.094 451.417,-150.269z">
                                                                <GeometryDrawing.Brush>
                                                                    <LinearGradientBrush EndPoint="486.709,-158.586" MappingMode="Absolute" SpreadMethod="Pad" StartPoint="493.474,-133.339">
                                                                        <GradientStop Color="White" Offset="0"/>
                                                                        <GradientStop Color="Transparent" Offset="1"/>
                                                                    </LinearGradientBrush>
                                                                </GeometryDrawing.Brush>
                                                            </GeometryDrawing>
                                                        </DrawingGroup>
                                                    </DrawingGroup>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <LinearGradientBrush x:Key="TabItem.Static.Background" EndPoint="0,1" StartPoint="0,0">
            <GradientStop Color="#F0F0F0" Offset="0.0"/>
            <GradientStop Color="#E5E5E5" Offset="1.0"/>
        </LinearGradientBrush>

        <SolidColorBrush x:Key="TabItem.Static.Border" Color="Transparent"/>

        <LinearGradientBrush x:Key="TabItem.MouseOver.Background" EndPoint="0,1" StartPoint="0,0" Opacity=".75">
            <GradientStop Color="Transparent" Offset="0.0"/>
            <GradientStop Color="Silver" Offset="0.5"/>
            <!--<GradientStop Color="#ECF4FC" Offset="0.0"/>-->
            <GradientStop Color="Transparent" Offset="1.0"/>
        </LinearGradientBrush>

        <SolidColorBrush x:Key="TabItem.MouseOver.Border" Color="Black"/>
        <SolidColorBrush x:Key="TabItem.Disabled.Background" Color="#F0F0F0"/>
        <SolidColorBrush x:Key="TabItem.Disabled.Border" Color="#D9D9D9"/>

        <LinearGradientBrush x:Key="TabItem.Selected.Border" EndPoint="0,1" StartPoint="0,0">
            <GradientStop Color="White" Offset="0.0"/>
            <GradientStop Color="Black" Offset="0.5"/>
            <!--<GradientStop Color="#ECF4FC" Offset="0.0"/>-->
            <GradientStop Color="Silver" Offset="1.0"/>
        </LinearGradientBrush>

        <SolidColorBrush x:Key="TabItem.Selected.Background" Color="Transparent"/>

        <Style TargetType="{x:Type TabItem}">
            <Setter Property="FocusVisualStyle" Value="{StaticResource FocusVisual}"/>
            <Setter Property="Foreground" Value="Gold"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="{StaticResource TabItem.Static.Border}"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="Padding" Value="6,2,6,2"/>
            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
            <Setter Property="VerticalContentAlignment" Value="Stretch"/>

            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabItem}">
                        <Grid x:Name="templateRoot" SnapsToDevicePixels="true">
                            <Border x:Name="mainBorder" BorderBrush="Transparent" BorderThickness="0,0,0,0" Background="{TemplateBinding Background}" Margin="0" CornerRadius="10,10,0,0">
                                <Border x:Name="innerBorder" BorderBrush="Silver" BorderThickness="1,1,1,0" Background="{StaticResource TabItem.Selected.Background}" Margin="-1" Opacity="0" CornerRadius="10,10,0,0">
                                    <Border.Effect>
                                        <DropShadowEffect/>
                                    </Border.Effect>
                                </Border>
                            </Border>

                            <ContentPresenter x:Name="contentPresenter"  ContentSource="Header" Focusable="False" HorizontalAlignment="Center" Margin="{TemplateBinding Padding}" RecognizesAccessKey="True" SnapsToDevicePixels="True" VerticalAlignment="Center">
                                <ContentPresenter.Effect>
                                    <DropShadowEffect/>
                                </ContentPresenter.Effect>
                            </ContentPresenter>
                        </Grid>

                        <ControlTemplate.Triggers>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}" Value="true"/>
                                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Left"/>
                                </MultiDataTrigger.Conditions>

                                <Setter Property="Background" TargetName="mainBorder" Value="{StaticResource TabItem.MouseOver.Background}"/>
                                <Setter Property="BorderBrush" TargetName="mainBorder" Value="Black"/>
                                <Setter Property="BorderThickness" TargetName="innerBorder" Value="1,1,0,1"/>
                                <Setter Property="BorderThickness" TargetName="mainBorder" Value="1,1,0,1"/>
                            </MultiDataTrigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}" Value="true"/>
                                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Bottom"/>
                                </MultiDataTrigger.Conditions>

                                <Setter Property="Background" TargetName="mainBorder" Value="{StaticResource TabItem.MouseOver.Background}"/>
                                <Setter Property="BorderBrush" TargetName="mainBorder" Value="Black"/>
                                <Setter Property="BorderThickness" TargetName="innerBorder" Value="1,0,1,1"/>
                                <Setter Property="BorderThickness" TargetName="mainBorder" Value="1,0,1,1"/>
                            </MultiDataTrigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}" Value="true"/>
                                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Right"/>
                                </MultiDataTrigger.Conditions>

                                <Setter Property="Background" TargetName="mainBorder" Value="{StaticResource TabItem.MouseOver.Background}"/>
                                <Setter Property="BorderBrush" TargetName="mainBorder" Value="Black"/>
                                <Setter Property="BorderThickness" TargetName="innerBorder" Value="0,1,1,1"/>
                                <Setter Property="BorderThickness" TargetName="mainBorder" Value="0,1,1,1"/>
                            </MultiDataTrigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}" Value="true"/>
                                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Top"/>
                                </MultiDataTrigger.Conditions>

                                <Setter Property="Background" TargetName="mainBorder" Value="{StaticResource TabItem.MouseOver.Background}"/>
                                <Setter Property="BorderBrush" TargetName="mainBorder" Value="Black"/>
                                <Setter Property="BorderThickness" TargetName="innerBorder" Value="1,1,1,0"/>
                                <Setter Property="BorderThickness" TargetName="mainBorder" Value="1,1,1,0"/>
                            </MultiDataTrigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsEnabled, RelativeSource={RelativeSource Self}}" Value="false"/>
                                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Left"/>
                                </MultiDataTrigger.Conditions>

                                <Setter Property="Opacity" TargetName="contentPresenter" Value="0.56"/>
                                <Setter Property="Background" TargetName="mainBorder" Value="{StaticResource TabItem.Disabled.Background}"/>
                                <Setter Property="BorderBrush" TargetName="mainBorder" Value="{StaticResource TabItem.Disabled.Border}"/>
                                <Setter Property="BorderThickness" TargetName="innerBorder" Value="1,1,0,1"/>
                                <Setter Property="BorderThickness" TargetName="mainBorder" Value="1,1,0,1"/>
                            </MultiDataTrigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsEnabled, RelativeSource={RelativeSource Self}}" Value="false"/>
                                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Bottom"/>
                                </MultiDataTrigger.Conditions>

                                <Setter Property="Opacity" TargetName="contentPresenter" Value="0.56"/>
                                <Setter Property="Background" TargetName="mainBorder" Value="{StaticResource TabItem.Disabled.Background}"/>
                                <Setter Property="BorderBrush" TargetName="mainBorder" Value="{StaticResource TabItem.Disabled.Border}"/>
                                <Setter Property="BorderThickness" TargetName="innerBorder" Value="1,0,1,1"/>
                                <Setter Property="BorderThickness" TargetName="mainBorder" Value="1,0,1,1"/>
                            </MultiDataTrigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsEnabled, RelativeSource={RelativeSource Self}}" Value="false"/>
                                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Right"/>
                                </MultiDataTrigger.Conditions>

                                <Setter Property="Opacity" TargetName="contentPresenter" Value="0.56"/>
                                <Setter Property="Background" TargetName="mainBorder" Value="{StaticResource TabItem.Disabled.Background}"/>
                                <Setter Property="BorderBrush" TargetName="mainBorder" Value="{StaticResource TabItem.Disabled.Border}"/>
                                <Setter Property="BorderThickness" TargetName="innerBorder" Value="0,1,1,1"/>
                                <Setter Property="BorderThickness" TargetName="mainBorder" Value="0,1,1,1"/>
                            </MultiDataTrigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsEnabled, RelativeSource={RelativeSource Self}}" Value="false"/>
                                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Top"/>
                                </MultiDataTrigger.Conditions>

                                <Setter Property="Opacity" TargetName="contentPresenter" Value="0.56"/>
                                <Setter Property="Background" TargetName="mainBorder" Value="{StaticResource TabItem.Disabled.Background}"/>
                                <Setter Property="BorderBrush" TargetName="mainBorder" Value="{StaticResource TabItem.Disabled.Border}"/>
                                <Setter Property="BorderThickness" TargetName="innerBorder" Value="1,1,1,0"/>
                                <Setter Property="BorderThickness" TargetName="mainBorder" Value="1,1,1,0"/>
                            </MultiDataTrigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="false"/>
                                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Left"/>
                                </MultiDataTrigger.Conditions>

                                <Setter Property="BorderThickness" TargetName="innerBorder" Value="1,1,0,1"/>
                                <Setter Property="BorderThickness" TargetName="mainBorder" Value="1,1,0,1"/>
                            </MultiDataTrigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="true"/>
                                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Left"/>
                                </MultiDataTrigger.Conditions>

                                <Setter Property="Panel.ZIndex" Value="1"/>
                                <Setter Property="Margin" Value="-2,-2,0,-2"/>
                                <Setter Property="Opacity" TargetName="innerBorder" Value="1"/>
                                <Setter Property="BorderThickness" TargetName="innerBorder" Value="1,1,0,0"/>
                                <Setter Property="BorderThickness" TargetName="mainBorder" Value="1,1,0,0"/>
                            </MultiDataTrigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="false"/>
                                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Bottom"/>
                                </MultiDataTrigger.Conditions>

                                <Setter Property="BorderThickness" TargetName="innerBorder" Value="1,0,1,1"/>
                                <Setter Property="BorderThickness" TargetName="mainBorder" Value="1,0,1,1"/>
                            </MultiDataTrigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="true"/>
                                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Bottom"/>
                                </MultiDataTrigger.Conditions>

                                <Setter Property="Panel.ZIndex" Value="1"/>
                                <Setter Property="Margin" Value="-2,0,-2,-2"/>
                                <Setter Property="Opacity" TargetName="innerBorder" Value="1"/>
                                <Setter Property="BorderThickness" TargetName="innerBorder" Value="1,0,1,0"/>
                                <Setter Property="BorderThickness" TargetName="mainBorder" Value="1,0,1,0"/>
                            </MultiDataTrigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="false"/>
                                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Right"/>
                                </MultiDataTrigger.Conditions>

                                <Setter Property="BorderThickness" TargetName="innerBorder" Value="0,1,1,1"/>
                                <Setter Property="BorderThickness" TargetName="mainBorder" Value="0,1,1,1"/>
                            </MultiDataTrigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="true"/>
                                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Right"/>
                                </MultiDataTrigger.Conditions>

                                <Setter Property="Panel.ZIndex" Value="1"/>
                                <Setter Property="Margin" Value="0,-2,-2,-2"/>
                                <Setter Property="Opacity" TargetName="innerBorder" Value="1"/>
                                <Setter Property="BorderThickness" TargetName="innerBorder" Value="0,1,1,0"/>
                                <Setter Property="BorderThickness" TargetName="mainBorder" Value="0,1,1,0"/>
                            </MultiDataTrigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="false"/>
                                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Top"/>
                                </MultiDataTrigger.Conditions>
                                <Setter Property="BorderThickness" TargetName="innerBorder" Value="1,1,1,0"/>
                                <Setter Property="BorderThickness" TargetName="mainBorder" Value="1,1,1,0"/>
                            </MultiDataTrigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="true"/>
                                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Top"/>
                                </MultiDataTrigger.Conditions>
                                <Setter Property="Panel.ZIndex" Value="1"/>
                                <Setter Property="Margin" Value="-2,-2,-2,0"/>
                                <Setter Property="Opacity" TargetName="innerBorder" Value="1"/>
                                <Setter Property="BorderThickness" TargetName="innerBorder" Value="1,1,1,0"/>
                                <Setter Property="BorderThickness" TargetName="mainBorder" Value="1,1,1,0"/>
                            </MultiDataTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <SolidColorBrush x:Key="TabItem.Selected.Background2" Color="Transparent"/>

        <Style TargetType="{x:Type TabControl}">
            <Setter Property="Padding" Value="2"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Background" Value="{StaticResource TabItem.Selected.Background}"/>
            <Setter Property="BorderBrush" Value="{StaticResource TabItem.Selected.Border}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>

            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabControl}">
                        <Grid x:Name="templateRoot" ClipToBounds="true" SnapsToDevicePixels="true" KeyboardNavigation.TabNavigation="Local">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition x:Name="ColumnDefinition0"/>
                                <ColumnDefinition x:Name="ColumnDefinition1" Width="0"/>
                            </Grid.ColumnDefinitions>

                            <Grid.RowDefinitions>
                                <RowDefinition x:Name="RowDefinition0" Height="Auto"/>
                                <RowDefinition x:Name="RowDefinition1" Height="*"/>
                            </Grid.RowDefinitions>

                            <TabPanel x:Name="headerPanel" Background="Transparent" Grid.Column="0" IsItemsHost="true" Margin="2,2,2,0" Grid.Row="0" KeyboardNavigation.TabIndex="1" Panel.ZIndex="1"/>

                            <Border x:Name="contentPanel" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" Grid.Column="0" KeyboardNavigation.DirectionalNavigation="Contained" Grid.Row="1" KeyboardNavigation.TabIndex="2" KeyboardNavigation.TabNavigation="Local">
                                <ContentPresenter x:Name="PART_SelectedContentHost" ContentSource="SelectedContent" Margin="{TemplateBinding Padding}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="TabStripPlacement" Value="Bottom">
                                <Setter Property="Grid.Row" TargetName="headerPanel" Value="1"/>
                                <Setter Property="Grid.Row" TargetName="contentPanel" Value="0"/>
                                <Setter Property="Height" TargetName="RowDefinition0" Value="*"/>
                                <Setter Property="Height" TargetName="RowDefinition1" Value="Auto"/>
                                <Setter Property="Margin" TargetName="headerPanel" Value="2,0,2,2"/>
                            </Trigger>
                            <Trigger Property="TabStripPlacement" Value="Left">
                                <Setter Property="Grid.Row" TargetName="headerPanel" Value="0"/>
                                <Setter Property="Grid.Row" TargetName="contentPanel" Value="0"/>
                                <Setter Property="Grid.Column" TargetName="headerPanel" Value="0"/>
                                <Setter Property="Grid.Column" TargetName="contentPanel" Value="1"/>
                                <Setter Property="Width" TargetName="ColumnDefinition0" Value="Auto"/>
                                <Setter Property="Width" TargetName="ColumnDefinition1" Value="*"/>
                                <Setter Property="Height" TargetName="RowDefinition0" Value="*"/>
                                <Setter Property="Height" TargetName="RowDefinition1" Value="0"/>
                                <Setter Property="Margin" TargetName="headerPanel" Value="2,2,0,2"/>
                            </Trigger>
                            <Trigger Property="TabStripPlacement" Value="Right">
                                <Setter Property="Grid.Row" TargetName="headerPanel" Value="0"/>
                                <Setter Property="Grid.Row" TargetName="contentPanel" Value="0"/>
                                <Setter Property="Grid.Column" TargetName="headerPanel" Value="1"/>
                                <Setter Property="Grid.Column" TargetName="contentPanel" Value="0"/>
                                <Setter Property="Width" TargetName="ColumnDefinition0" Value="*"/>
                                <Setter Property="Width" TargetName="ColumnDefinition1" Value="Auto"/>
                                <Setter Property="Height" TargetName="RowDefinition0" Value="*"/>
                                <Setter Property="Height" TargetName="RowDefinition1" Value="0"/>
                                <Setter Property="Margin" TargetName="headerPanel" Value="0,2,2,2"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="TextElement.Foreground" TargetName="templateRoot" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <SolidColorBrush x:Key="Menu.Static.Background" Color="Transparent"/>

        <Style TargetType="{x:Type Menu}">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="FontFamily" Value="{DynamicResource {x:Static SystemFonts.MenuFontFamilyKey}}"/>
            <Setter Property="FontSize" Value="{DynamicResource {x:Static SystemFonts.MenuFontSizeKey}}"/>
            <Setter Property="FontStyle" Value="{DynamicResource {x:Static SystemFonts.MenuFontStyleKey}}"/>
            <Setter Property="FontWeight" Value="{DynamicResource {x:Static SystemFonts.MenuFontWeightKey}}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Menu}">
                        <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="Transparent" Padding="{TemplateBinding Padding}" SnapsToDevicePixels="true">
                            <ItemsPresenter SnapsToDevicePixels="True"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <SolidColorBrush x:Key="Menu.Static.Foreground" Color="White"/>
        <SolidColorBrush x:Key="Menu.Static.Border" Color="Transparent"/>

        <Style TargetType="{x:Type MenuItem}">
            <Setter Property="Foreground" Value="#FF404040"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>

            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <Grid SnapsToDevicePixels="true">
                            <DockPanel>
                                <ContentPresenter x:Name="content" ContentSource="Header" Margin="{TemplateBinding Padding}" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}">
                                    <ContentPresenter.Effect>
                                        <DropShadowEffect/>
                                    </ContentPresenter.Effect>
                                </ContentPresenter>
                            </DockPanel>

                            <Popup x:Name="PART_Popup" AllowsTransparency="true" Focusable="false" HorizontalOffset="1" IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}" PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}" Placement="Bottom" VerticalOffset="-1">

                                <Border BorderThickness="2" Padding="3,1,3,2" CornerRadius="5" Opacity="1" >
                                    <Border.Background>
                                        <RadialGradientBrush>
                                            <GradientStop Color="Silver" Offset="1"/>
                                            <GradientStop Color="White" Offset="0.5"/>
                                        </RadialGradientBrush>
                                    </Border.Background>

                                    <Border.BorderBrush>
                                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                            <GradientStop Color="Black" Offset="1"/>
                                            <GradientStop Color="White"/>

                                        </LinearGradientBrush>
                                    </Border.BorderBrush>

                                    <ScrollViewer x:Name="SubMenuScrollViewer" CanContentScroll="true" Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly={x:Type FrameworkElement}}}">
                                        <Grid RenderOptions.ClearTypeHint="Enabled">
                                            <ItemsPresenter x:Name="ItemsPresenter" KeyboardNavigation.DirectionalNavigation="Cycle" Grid.IsSharedSizeScope="true" Margin="2" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" KeyboardNavigation.TabNavigation="Cycle"/>
                                        </Grid>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="TextBlock.Foreground" Value="Black" TargetName="content"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <SolidColorBrush x:Key="Menu.Static.Separator" Color="Gold"/>
        <Style x:Key="{x:Static MenuItem.SeparatorStyleKey}" TargetType="Separator">
            <Setter Property="Background" Value="{StaticResource Menu.Static.Separator}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Menu.Static.Separator}"/>
            <Setter Property="MinHeight" Value="1"/>
            <Setter Property="SnapsToDevicePixels" Value="true"/>
            <Setter Property="OverridesDefaultStyle" Value="true" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Separator}">
                        <Border BorderThickness="2,2,2,2" Background="{TemplateBinding Background}" Margin="0,0,0,0">
                            <Border.BorderBrush>
                                <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                    <GradientStop Offset="0" Color="Silver"/>
                                    <GradientStop Offset="1" Color="Silver"/>
                                    <GradientStop Color="Gold" Offset="0.25"/>
                                    <GradientStop Color="Gold" Offset="0.75"/>
                                </LinearGradientBrush>
                            </Border.BorderBrush>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <DockPanel x:Name="dckBackground" >
        <DockPanel.Background>
            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                <GradientStop Color="Black" Offset="0"/>
                <GradientStop Color="White" Offset="1"/>
            </LinearGradientBrush>
        </DockPanel.Background>

        <DockPanel.Effect>
            <DropShadowEffect
        BlurRadius="10"
        Color="Black"
        Direction="270"
        ShadowDepth="3"/>
        </DockPanel.Effect>

        <Border Name="titleBar" DockPanel.Dock="Top" Grid.Row="0" Background="Black" BorderThickness="3" Padding="0">
            <Border.Effect>
                <DropShadowEffect/>
            </Border.Effect>

            <Border.BorderBrush>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="Silver" Offset="0.5"/>
                    <GradientStop Color="White" Offset="1"/>
                    <GradientStop Color="White"/>
                </LinearGradientBrush>
            </Border.BorderBrush>

            <DockPanel DockPanel.Dock="Top" VerticalAlignment="Center">
                <Grid DockPanel.Dock="Right">
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                    </Grid.RowDefinitions>

                    <Button x:Name="btnClose" DockPanel.Dock="Right" Width="32" Height="32" Style="{DynamicResource CloseButtonStyle}" Click="btnClose_Click" VerticalAlignment="Bottom" HorizontalAlignment="Center">
                        <Path Width="16.8" Height="12" Stretch="Uniform" UseLayoutRounding="False" Fill="Black" Data="F1 M 151,217L 152,217L 154.5,219.5L 157,217L 158,217L 158,218L 155.5,220.5L 158,223L 158,224L 157,224L 154.5,221.5L 152,224L 151,224L 151,223L 153.5,220.5L 151,218L 151,217 Z"/>
                    </Button>

                    <Border Grid.Row="1" Height="50" Width="50" VerticalAlignment="Top" Margin="0,0,-8,0" Opacity="0.75" HorizontalAlignment="Center">
                        <Border.Background>
                            <VisualBrush Visual="{Binding BindsDirectlyToSource=True, ElementName=btnClose, Mode=OneWay}">
                                <VisualBrush.Transform>
                                    <TransformGroup>
                                        <ScaleTransform ScaleY="-1" ScaleX="0.95"/>
                                        <SkewTransform/>
                                        <RotateTransform/>
                                        <TranslateTransform Y="40"/>
                                    </TransformGroup>
                                </VisualBrush.Transform>
                            </VisualBrush>
                        </Border.Background>

                        <Border.OpacityMask>
                            <LinearGradientBrush StartPoint="0.5,0.0" EndPoint="0.5,1.0">
                                <GradientStop Offset="0.0" Color="#00000000" />
                                <GradientStop Offset="1.0" Color="#FF000000" />
                            </LinearGradientBrush>
                        </Border.OpacityMask>
                    </Border>
                </Grid>

                <Grid DockPanel.Dock="Right">
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                    </Grid.RowDefinitions>

                    <Button x:Name="btnRestore" DockPanel.Dock="Right" Width="32" Height="32" Style="{DynamicResource RestoreButtonStyle}" Click="btnRestore_Click" VerticalAlignment="Bottom" HorizontalAlignment="Center" Margin="5,5,2.5,0">
                        <Path x:Name="pthRestore" Width="16.8" Height="12" Stretch="Uniform" UseLayoutRounding="False" Fill="Black" Data="F1 M 34,17L 43,17L 43,23L 34,23L 34,17 Z M 35,19L 35,22L 42,22L 42,19L 35,19 Z"/>
                    </Button>

                    <Border Grid.Row="1" Height="50" Width="50" VerticalAlignment="Top" Margin="0,0,-8,0" Opacity="0.75" HorizontalAlignment="Center">
                        <Border.Background>
                            <VisualBrush Visual="{Binding BindsDirectlyToSource=True, ElementName=btnRestore, Mode=OneWay}">
                                <VisualBrush.Transform>
                                    <TransformGroup>
                                        <ScaleTransform ScaleY="-1" ScaleX="0.95"/>
                                        <SkewTransform/>
                                        <RotateTransform/>
                                        <TranslateTransform Y="40"/>
                                    </TransformGroup>
                                </VisualBrush.Transform>
                            </VisualBrush>
                        </Border.Background>

                        <Border.OpacityMask>
                            <LinearGradientBrush StartPoint="0.5,0.0" EndPoint="0.5,1.0">
                                <GradientStop Offset="0.0" Color="#00000000" />
                                <GradientStop Offset="1.0" Color="#FF000000" />
                            </LinearGradientBrush>
                        </Border.OpacityMask>
                    </Border>
                </Grid>

                <Grid DockPanel.Dock="Right">
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                    </Grid.RowDefinitions>

                    <Button x:Name="btnMinimize" DockPanel.Dock="Right" Width="32" Height="32" Style="{DynamicResource MinimizeButtonStyle}" Click="btnMinimize_Click" VerticalAlignment="Bottom" HorizontalAlignment="Center" Margin="5,5,2.5,0">
                        <Path Width="16.8" Height="12" Stretch="Uniform" UseLayoutRounding="False" Fill="Black" Data="M0,0 L8,0 8,1 8,2 0,2 0,1 z"/>
                    </Button>

                    <Border Grid.Row="1" Height="50" Width="50" VerticalAlignment="Top" Margin="0,0,-8,0" Opacity="0.75" HorizontalAlignment="Center">
                        <Border.Background>
                            <VisualBrush Visual="{Binding BindsDirectlyToSource=True, ElementName=btnMinimize, Mode=OneWay}">
                                <VisualBrush.Transform>
                                    <TransformGroup>
                                        <ScaleTransform ScaleY="-1" ScaleX="0.95"/>
                                        <SkewTransform/>
                                        <RotateTransform/>
                                        <TranslateTransform Y="40"/>
                                    </TransformGroup>
                                </VisualBrush.Transform>
                            </VisualBrush>
                        </Border.Background>

                        <Border.OpacityMask>
                            <LinearGradientBrush StartPoint="0.5,0.0" EndPoint="0.5,1.0">
                                <GradientStop Offset="0.0" Color="#00000000" />
                                <GradientStop Offset="1.0" Color="#FF000000" />
                            </LinearGradientBrush>
                        </Border.OpacityMask>
                    </Border>
                </Grid>

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Background="Black"/>

                    <Border Grid.Row="1">
                        <Border.Background>
                            <RadialGradientBrush GradientOrigin="0.5,1" Center="0.5,1" RadiusY="0.8">
                                <GradientStop Color="Black" Offset="1"/>
                                <GradientStop Color="Silver"/>
                            </RadialGradientBrush>
                        </Border.Background>
                    </Border>

                    <Label x:Name="lblTitle" Grid.Row="0" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center" Padding="5,5,5,0" FontWeight="Bold" FontSize="24">
                        <Label.Foreground>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="Gold"/>
                                <GradientStop Color="Silver" Offset="0.917"/>
                            </LinearGradientBrush>
                        </Label.Foreground>
                        City of Titans Power Designer
                    </Label>

                    <Border Grid.Row="1" Height="50" VerticalAlignment="Top" Margin="0" Opacity="0.75">
                        <Border.Background>
                            <VisualBrush Visual="{Binding ElementName=lblTitle}">
                                <VisualBrush.Transform>
                                    <ScaleTransform ScaleX="1" ScaleY="-1" CenterX="100" CenterY="25"/>
                                </VisualBrush.Transform>
                            </VisualBrush>
                        </Border.Background>

                        <Border.OpacityMask>
                            <LinearGradientBrush StartPoint="0.5,0.0" EndPoint="0.5,1.0">
                                <GradientStop Offset="0.0" Color="#00000000" />
                                <GradientStop Offset="1.0" Color="#FF000000" />
                            </LinearGradientBrush>
                        </Border.OpacityMask>
                    </Border>
                </Grid>
            </DockPanel>
        </Border>

        <Border DockPanel.Dock="Top" BorderThickness="3" CornerRadius="10" Margin="0,6,0,5" Padding="5">
            <Border.Effect>
                <DropShadowEffect/>
            </Border.Effect>

            <Border.BorderBrush>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="Silver" Offset="0.494"/>
                    <GradientStop Color="White"/>
                    <GradientStop Color="Black" Offset="1"/>
                </LinearGradientBrush>
            </Border.BorderBrush>

            <DockPanel DockPanel.Dock="Top">
                <Menu DockPanel.Dock="Right" Background="{x:Null}">
                    <MenuItem Header="_Help" Foreground="White" Background="#00000000">
                        <MenuItem Header="Editing Powers">
                        </MenuItem>
                        <MenuItem Header="Editing Controls">
                        </MenuItem>
                        <MenuItem Header="Editing Assets">
                        </MenuItem>
                        <MenuItem Header="Editing NPCs">
                        </MenuItem>
                        <Separator/>
                        <MenuItem Header="Gameplay Workroom Docs"/>
                        <Separator/>
                        <MenuItem x:Name="mnuHelpAbout" Header="_About" Click="mnuHelpAbout_Click">
                        </MenuItem>
                    </MenuItem>
                </Menu>

                <Menu >
                    <MenuItem Header="_File" Foreground="White">
                        <MenuItem Header="_Load CVS"></MenuItem>
                        <MenuItem Header="_Save CVS"></MenuItem>

                        <MenuItem Header="_Load Database"></MenuItem>
                        <MenuItem Header="_Save Database"></MenuItem>

                        <Separator/>

                        <MenuItem Header="_Download CVS"></MenuItem>
                        <MenuItem Header="_Upload CVS"></MenuItem>

                        <MenuItem Header="_Download Database"></MenuItem>
                        <MenuItem Header="_Upload Database"></MenuItem>

                        <Separator/>

                        <MenuItem Header="_Print CVS"></MenuItem>

                        <Separator/>

                        <MenuItem Header="E_xit" Click="btnClose_Click"></MenuItem>
                    </MenuItem>
                </Menu>
            </DockPanel>
        </Border>

        <StackPanel Name="placementTarget" DockPanel.Dock="Top">
            <Popup x:Name="popAbout" IsOpen="False"            
        		AllowsTransparency="True" 
        		PopupAnimation="Fade"  
        		HorizontalOffset="0"  
        		VerticalOffset="0" PlacementTarget="{Binding ElementName=placementTarget, Mode=OneWay}" Width="{Binding ActualWidth, ElementName=wndMain, Mode=OneWay}" StaysOpen="False" SnapsToDevicePixels="True">

                <Border Padding="5">
                    <Border>
                        <Border.Effect>
                            <DropShadowEffect/>
                        </Border.Effect>
                        <Border.Background>
                            <ImageBrush ImageSource="Assets/old-paper-texture-background.jpg" Stretch="UniformToFill"/>
                        </Border.Background>
                        <Canvas Width="400" Height="300">
                            <FlowDocumentReader Width="400" Height="300" ViewingMode="Page">
                                <FlowDocument>
                                    <Paragraph FontWeight="Bold" FontSize="29.333" TextAlignment="Center" Margin="0">
                                        City of Titans
                                        <LineBreak/>
                                        Power Designer
                                    </Paragraph>

                                    <Paragraph FontStyle="Italic" FontSize="12" TextAlignment="Center">
                                        Version:
                                        <Run Name="txtVersion" />
                                    </Paragraph>

                                    <Paragraph TextAlignment="Center" TextDecorations="Underline" FontWeight="Bold" FontSize="10">
                                        Development Team
                                    </Paragraph>

                                    <Section>
                                        <Paragraph TextAlignment="Center" FontStyle="Italic" Margin="0"  FontSize="10">
                                            Programmer
                                        </Paragraph>

                                        <Paragraph TextAlignment="Center" Margin="0" FontSize="10">
                                            Richard Robertson
                                        </Paragraph>
                                    </Section>

                                    <Paragraph Margin="0" FontSize="10"></Paragraph>

                                    <Section>
                                        <Paragraph TextAlignment="Center" FontStyle="Italic" Margin="0" FontSize="10">
                                            Design
                                        </Paragraph>

                                        <Paragraph TextAlignment="Center" Margin="0" FontSize="10">
                                            Richard Robertson
                                        </Paragraph>
                                    </Section>

                                    <Paragraph Margin="0" FontSize="10"></Paragraph>

                                    <Section>
                                        <Paragraph TextAlignment="Center" FontStyle="Italic" Margin="0" FontSize="10">
                                            Layout
                                        </Paragraph>

                                        <Paragraph TextAlignment="Center" Margin="0" FontSize="10">
                                            Richard Robertson
                                        </Paragraph>
                                    </Section>
                                </FlowDocument>
                            </FlowDocumentReader>
                        </Canvas>
                    </Border>
                </Border>
            </Popup>
        </StackPanel>

        <Grid DockPanel.Dock="Bottom">
            <Label HorizontalAlignment="Center">Missing Worlds Media, Inc. © 2015</Label>
        </Grid>

        <TabControl >
            <TabItem Header="Powers">
                <TabControl>
                    <TabItem Header="Categories">
                        <TabControl>
                            <TabItem Header="Effect">
                                <TabControl>
                                    <TabItem Header="Alter Meter"></TabItem>

                                    <TabItem Header="Alter Parameter"></TabItem>

                                    <TabItem Header="Apply Vector"></TabItem>

                                    <TabItem Header=" Alter Effective Distance"></TabItem>
                                </TabControl>
                            </TabItem>

                            <TabItem Header="Status">
                                <TabControl>
                                    <TabItem Header="Alter Appearance"></TabItem>

                                    <TabItem Header="Alter User Interface"></TabItem>

                                    <TabItem Header="Travel"></TabItem>

                                    <TabItem Header="Create Meter/Parameter"></TabItem>

                                    <TabItem Header="Control"></TabItem>
                                </TabControl>
                            </TabItem>

                            <TabItem Header="Point Travel">
                                <TabControl>
                                    <TabItem Header="Point-to-Point"></TabItem>

                                    <TabItem Header="Ally-to-Point"></TabItem>

                                    <TabItem Header="Point-to-Zone"></TabItem>

                                    <TabItem Header="Point-to-Objective"></TabItem>
                                </TabControl>
                            </TabItem>

                            <TabItem Header="Summon">
                                <TabControl>
                                    <TabItem Header="Summon Ally"></TabItem>

                                    <TabItem Header="Summon Pet"></TabItem>

                                    <TabItem Header="Summon Object"></TabItem>

                                    <TabItem Header="Summon Anchor"></TabItem>

                                    <TabItem Header="Summon Image"></TabItem>
                                </TabControl>
                            </TabItem>
                        </TabControl>
                    </TabItem>

                    <TabItem Header="Common Power Elements"></TabItem>
                </TabControl>
            </TabItem>

            <TabItem Header="Controls"></TabItem>

            <TabItem Header="Assets"></TabItem>

            <TabItem Header="NPC Design"></TabItem>
        </TabControl>
    </DockPanel>
</Window>
